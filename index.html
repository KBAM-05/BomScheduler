<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ì•„ì´ ë§ì¶¤ ì£¼ê°„ ìŠ¤ì¼€ì¤„ëŸ¬ v2.1</title>
    <link rel="manifest" href="/manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #FDFBF8; color: #4A4A4A; }
        .timeline-item { position: relative; padding-left: 2rem; display: flex; align-items: flex-start; gap: 1rem; }
        .timeline-item::before { content: ''; position: absolute; left: 1.25rem; top: 1.25rem; bottom: -1.25rem; width: 2px; background-color: #EAEAEA; transform: translateX(-50%); }
        .timeline-item:last-child::before { display: none; }
        .tab-active { background-color: #A4C3B2; color: white; font-weight: 700; }
        .tab-inactive { background-color: #F0F0F0; color: #6B7280; }
        .analysis-tab-active { background-color: #5F9EA0; color: white; font-weight: 700; }
        .analysis-tab-inactive { background-color: #E0F2F7; color: #3B666B; }
        .current-activity { background-color: #FFFBEB; border-left-color: #F59E0B !important; transform: scale(1.02); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); z-index: 10; }
        .completed-activity .activity-text { text-decoration: line-through; color: #9CA3AF; }
        #schedule-content { max-height: 500px; overflow-y: auto; padding-right: 10px; }
        #editModal.hidden, #management-overlay.hidden { display: none; }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-7xl">
        <header class="text-center mb-8 relative">
            <h1 class="text-3xl sm:text-4xl font-bold text-[#3B666B] mb-2">ìš°ë¦¬ì•„ì´ ë§ì¶¤ ì£¼ê°„ ìŠ¤ì¼€ì¤„ëŸ¬ v2.1</h1>
            <p class="text-lg text-gray-600">ì•„ì´ì˜ í•˜ë£¨ë¥¼ ì‚¬ë‘ê³¼ ê³„íšìœ¼ë¡œ ì±„ì›Œì£¼ì„¸ìš”</p>
            <button id="manage-schedule-btn" title="ì „ì²´ ì¼ì • ê´€ë¦¬" class="absolute top-0 right-0 bg-white p-3 rounded-full shadow-md hover:bg-gray-100 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
            </button>
        </header>

        <main class="lg:grid lg:grid-cols-3 lg:gap-8">
            <div class="lg:col-span-2">
                <section id="daily-schedule" class="bg-white p-6 rounded-2xl shadow-lg mb-8">
                    <h2 class="text-2xl font-bold text-[#3B666B] mb-4">ì˜¤ëŠ˜ì˜ ì¼ì •</h2>
                    <p class="text-gray-600 mb-6">í˜„ì¬ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ í•´ì•¼ í•  í™œë™ì„ í™•ì¸í•˜ê³ , ì™„ë£Œ ì‹œ ì²´í¬ë°•ìŠ¤ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
                    <div id="day-tabs" class="flex flex-wrap gap-2 mb-6"></div>
                    <div id="schedule-content" class="space-y-6"></div>
                </section>
                <section id="analysis-section" class="bg-white p-6 rounded-2xl shadow-lg h-full">
                    <h2 class="text-2xl font-bold mb-4 text-[#3B666B]">í™œë™ ë¶„ì„</h2>
                    <div class="flex gap-2 mb-4">
                        <button id="weekly-analysis-tab" class="px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 analysis-tab-active">ì£¼ê°„</button>
                        <button id="daily-analysis-tab" class="px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 analysis-tab-inactive">ì¼ê°„</button>
                    </div>
                    <div id="weekly-analysis-content"><div class="chart-container"><canvas id="weeklyActivityChart"></canvas></div></div>
                    <div id="daily-analysis-content" class="hidden"><div class="chart-container"><canvas id="dailyActivityChart"></canvas></div></div>
                </section>
            </div>
            <div class="lg:col-span-1 mt-8 lg:mt-0">
                <section id="explore-schedule-section" class="bg-white p-6 rounded-2xl shadow-lg mb-8">
                    <h2 class="text-2xl font-bold mb-4 text-[#3B666B]">ìš”ì¼ë³„ ìŠ¤ì¼€ì¤„ íƒìƒ‰</h2>
                    <div id="explore-day-tabs" class="flex flex-wrap gap-2 mb-6"></div>
                    <div id="schedule-content-explore" class="space-y-4"></div>
                </section>
            </div>
        </main>
    </div>

    <div id="management-overlay" class="hidden fixed inset-0 bg-white z-50 p-4 sm:p-8 overflow-y-auto">
        <div class="max-w-4xl mx-auto">
            <div class="flex justify-between items-center mb-6"><h2 class="text-3xl font-bold text-[#3B666B]">ì „ì²´ ì¼ì • ê´€ë¦¬</h2><button id="close-management-btn" class="text-3xl text-gray-500 hover:text-gray-800">&times;</button></div>
            <div id="management-content" class="space-y-8"></div>
        </div>
    </div>

    <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-[60] p-4">
        <div class="bg-white p-6 rounded-lg w-full max-w-md shadow-xl max-h-full overflow-y-auto">
            <h3 id="modalTitle" class="text-2xl font-bold mb-4"></h3>
            <input type="hidden" id="modalDay"><input type="hidden" id="modalIndex">
            <div class="space-y-4">
                <div><label for="modalTime" class="block text-sm font-medium text-gray-700">ì‹œê°„</label><input type="time" id="modalTime" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                <div><label for="modalActivity" class="block text-sm font-medium text-gray-700">í™œë™ ì´ë¦„</label><input type="text" id="modalActivity" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
                <div><label for="modalDescription" class="block text-sm font-medium text-gray-700">ì„¤ëª…</label><textarea id="modalDescription" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></textarea></div>
                <div><label for="modalCategory" class="block text-sm font-medium text-gray-700">ì¹´í…Œê³ ë¦¬</label><select id="modalCategory" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></select></div>
                <div><label for="modalIcon" class="block text-sm font-medium text-gray-700">ì•„ì´ì½˜</label><input type="text" id="modalIcon" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"></div>
            </div>
            <div class="mt-6 flex justify-end gap-3"><button id="cancelButton" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-md">ì·¨ì†Œ</button><button id="saveButton" class="px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-md">ì €ì¥</button></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let scheduleData = {};
            const categoryColors = { 'ì¹˜ë£Œ': '#FF7F50', 'í•™ìŠµ': '#6495ED', 'ë…ì„œ': '#8A2BE2', 'ë†€ì´': '#3CB371', 'íœ´ì‹': '#FFD700', 'ê¸°ë³¸ìƒí™œ': '#A9A9A9', 'ì™¸ë¶€ìˆ˜ì—…': '#DC143C' };
            const defaultSchedule = {
                'ì›”': [{ time: '17:00', activity: 'ì§‘ ë„ì°©, íœ´ì‹ ë° ììœ  ë†€ì´', description: 'ê°„ì‹ì„ ë¨¹ê³ , ì•„ì´ê°€ ì›í•˜ëŠ” ë†€ì´ë¥¼ í•˜ë©° í¸ì•ˆí•œ ì‹œê°„ì„ ë³´ë‚´ìš”.', category: 'íœ´ì‹', icon: 'ğŸ ' }, { time: '17:30', activity: 'ê°œë³„ í•™ìŠµ: í•œê¸€', description: 'ë§¤ì¼ ê¾¸ì¤€íˆ í•œê¸€ì„ ìµíˆëŠ” ì‹œê°„ì´ì—ìš”.', category: 'í•™ìŠµ', icon: 'ğŸ“š' }, { time: '18:00', activity: 'ì €ë… ì‹ì‚¬ ì¤€ë¹„ ë•ê¸°', description: 'ì‹ì‚¬ ì¤€ë¹„ë¥¼ ë„ìš°ë©° ì±…ì„ê°ì„ ê¸¸ëŸ¬ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '18:30', activity: 'ì €ë… ì‹ì‚¬', description: 'ì˜¨ ê°€ì¡±ì´ í•¨ê»˜ ì¦ê±°ìš´ ì‹ì‚¬ ì‹œê°„ì„ ê°€ì ¸ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '19:30', activity: 'í•¨ê»˜ ì±… ì½ê¸°', description: 'ì•„ì´ì˜ ìƒìƒë ¥ì„ ìê·¹í•˜ëŠ” ì¬ë¯¸ìˆëŠ” ì±…ì„ í•¨ê»˜ ì½ì–´ìš”.', category: 'ë…ì„œ', icon: 'ğŸ“–' }, { time: '20:00', activity: 'ììœ  ë†€ì´ ë° íœ´ì‹', description: 'ì•„ì´ê°€ ì¢‹ì•„í•˜ëŠ” í™œë™ìœ¼ë¡œ í•˜ë£¨ë¥¼ ì¦ê²ê²Œ ë§ˆë¬´ë¦¬í•´ìš”.', category: 'ë†€ì´', icon: 'ğŸ‰' }, { time: '21:00', activity: 'ë‚´ì¼ ì¤€ë¹„ë¬¼ ì±™ê¸°ê¸°', description: 'ë‚´ì¼ í•„ìš”í•œ ë¬¼ê±´ë“¤ì„ ë¯¸ë¦¬ ì±™ê²¨ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ’' }, { time: '21:30', activity: 'ì·¨ì¹¨ ì¤€ë¹„', description: 'ë‚´ì¼ì„ ìœ„í•´ ì°¨ë¶„í•˜ê²Œ ì ìë¦¬ì— ë“¤ ì¤€ë¹„ë¥¼ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ì”»ê¸°' }, ],
                'í™”': [{ time: '17:00', activity: 'ì§‘ ë„ì°©, ê°„ì‹ ë° íœ´ì‹', description: 'í•™êµ ë‹¤ë…€ì˜¨ í›„ ì¶©ë¶„íˆ ì‰¬ëŠ” ì‹œê°„ì„ ê°€ì ¸ìš”.', category: 'íœ´ì‹', icon: 'ğŸ ' }, { time: '17:30', activity: 'ìŒì•… ê°ìƒ ë° ë¦¬ë“¬ ë†€ì´', description: 'ë‹¤ì–‘í•œ ìŒì•…ì„ ë“£ê³  ë¦¬ë“¬ì„ ëŠê»´ë´ìš”.', category: 'ë†€ì´', icon: 'ğŸ¶' }, { time: '18:00', activity: 'ê°œë³„ í•™ìŠµ: ìˆ˜í•™', description: 'ìˆ«ìì™€ ë„í˜•ì„ ì¬ë¯¸ìˆê²Œ ë°°ì›Œìš”.', category: 'í•™ìŠµ', icon: 'ğŸ“š' }, { time: '18:30', activity: 'ì €ë… ì‹ì‚¬', description: 'ë§›ìˆëŠ” ì €ë…ì„ ë¨¹ìœ¼ë©° ë„ë€ë„ë€ ì´ì•¼ê¸°í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '19:30', activity: 'í•œê¸€/ìˆ˜í•™ ìˆ˜ì—… (ì™¸ë¶€)', description: 'ì™¸ë¶€ ìˆ˜ì—…ì— ì°¸ì—¬í•˜ë©° ìƒˆë¡œìš´ ê²ƒì„ ë°°ì›Œìš”.', category: 'ì™¸ë¶€ìˆ˜ì—…', icon: 'ğŸ«' }, { time: '20:30', activity: 'ìˆ˜ì—… í›„ íœ´ì‹ ë° ììœ  ë†€ì´', description: 'ìˆ˜ì—…ìœ¼ë¡œ ì§€ì¹œ ëª¸ê³¼ ë§ˆìŒì„ ì‰¬ê²Œ í•´ì¤˜ìš”.', category: 'ë†€ì´', icon: 'ğŸ‰' }, { time: '21:00', activity: 'ë‚´ì¼ í•™ìŠµ ì¤€ë¹„ë¬¼ í™•ì¸', description: 'ë‚´ì¼ í•„ìš”í•œ í•™ìŠµ ë„êµ¬ë¥¼ í™•ì¸í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ“' }, { time: '21:30', activity: 'ì·¨ì¹¨ ì¤€ë¹„', description: 'ë‚´ì¼ì„ ìœ„í•´ ì°¨ë¶„í•˜ê²Œ ì ìë¦¬ì— ë“¤ ì¤€ë¹„ë¥¼ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ì”»ê¸°' }, ],
                'ìˆ˜': [{ time: '16:30', activity: 'í†µí•© ê°ê° ì¹˜ë£Œ (ì™¸ë¶€)', description: 'ì¹˜ë£Œë¥¼ í†µí•´ ë‹¤ì–‘í•œ ê°ê°ì„ ê²½í—˜í•˜ê³  ë°œë‹¬ì‹œì¼œìš”.', category: 'ì¹˜ë£Œ', icon: '?' }, { time: '17:30', activity: 'ì§‘ ë„ì°© ë° íœ´ì‹', description: 'ì¹˜ë£Œ í›„ ì§‘ì— ì™€ì„œ í¸ì•ˆí•˜ê²Œ ì‰¬ì–´ìš”.', category: 'íœ´ì‹', icon: 'ğŸ ' }, { time: '18:00', activity: 'ê°œë³„ í•™ìŠµ: ì˜ì–´ ë‹¨ì–´', description: 'ì¬ë¯¸ìˆëŠ” ê·¸ë¦¼ê³¼ í•¨ê»˜ ì˜ì–´ ë‹¨ì–´ë¥¼ ìµí˜€ìš”.', category: 'í•™ìŠµ', icon: 'ğŸ“š' }, { time: '18:30', activity: 'ì €ë… ì‹ì‚¬', description: 'ì—ë„ˆì§€ë¥¼ ë³´ì¶©í•˜ëŠ” ì¦ê±°ìš´ ì €ë… ì‹œê°„ì´ì—ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '19:30', activity: 'ê°€ì¡±ê³¼ í•¨ê»˜ ë³´ë“œê²Œì„', description: 'ë³´ë“œê²Œì„ì„ í•˜ë©° ê°€ì¡±ê³¼ ì¦ê±°ìš´ ì‹œê°„ì„ ë³´ë‚´ìš”.', category: 'ë†€ì´', icon: 'ğŸ²' }, { time: '20:10', activity: 'í•¨ê»˜ ì±… ì½ê¸° ë˜ëŠ” ê°€ë²¼ìš´ ë†€ì´', description: 'ì°¨ë¶„í•œ í™œë™ìœ¼ë¡œ í•˜ë£¨ë¥¼ ì •ë¦¬í•´ìš”.', category: 'ë…ì„œ', icon: 'ğŸ“–' }, { time: '21:00', activity: 'ê°œì¸ ìœ„ìƒ ê´€ë¦¬', description: 'ì–‘ì¹˜, ì„¸ìˆ˜ ë“± ìŠ¤ìŠ¤ë¡œ ìœ„ìƒì„ ê´€ë¦¬í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸª¥' }, { time: '21:30', activity: 'ì·¨ì¹¨ ì¤€ë¹„', description: 'ë‚´ì¼ì„ ìœ„í•´ ì°¨ë¶„í•˜ê²Œ ì ìë¦¬ì— ë“¤ ì¤€ë¹„ë¥¼ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ì”»ê¸°' }, ],
                'ëª©': [{ time: '16:00', activity: 'ì¸ì§€ ì¹˜ë£Œ (ì™¸ë¶€)', description: 'ìƒê°í•˜ëŠ” í˜ì„ ê¸°ë¥´ëŠ” ì¦ê±°ìš´ ì¹˜ë£Œ ì‹œê°„ì´ì—ìš”.', category: 'ì¹˜ë£Œ', icon: 'ğŸ§ ' }, { time: '17:00', activity: 'ì§‘ ë„ì°© ë° íœ´ì‹', description: 'ì¹˜ë£Œ í›„ ì§‘ì— ì™€ì„œ í¸ì•ˆí•˜ê²Œ ì‰¬ì–´ìš”.', category: 'íœ´ì‹', icon: 'ğŸ ' }, { time: '17:30', activity: 'ë¯¸ìˆ  í™œë™', description: 'í¬ë ˆìš©, ë¬¼ê°ìœ¼ë¡œ ììœ ë¡­ê²Œ í‘œí˜„í•´ìš”.', category: 'ë†€ì´', icon: 'ğŸ¨' }, { time: '18:00', activity: 'ê°œë³„ í•™ìŠµ: ê³¼í•™ íƒêµ¬', description: 'ê°„ë‹¨í•œ ê³¼í•™ ì‹¤í—˜ìœ¼ë¡œ í˜¸ê¸°ì‹¬ì„ í‚¤ì›Œìš”.', category: 'í•™ìŠµ', icon: 'ğŸ”¬' }, { time: '18:30', activity: 'ì €ë… ì‹ì‚¬', description: 'ë§›ìˆëŠ” ì €ë…ìœ¼ë¡œ ì—ë„ˆì§€ë¥¼ ì±„ì›Œìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '19:30', activity: 'í•œê¸€/ìˆ˜í•™ ìˆ˜ì—… (ì™¸ë¶€)', description: 'ì™¸ë¶€ ìˆ˜ì—…ì„ í†µí•´ ì¦ê²ê²Œ ë°°ì›Œìš”.', category: 'ì™¸ë¶€ìˆ˜ì—…', icon: 'ğŸ«' }, { time: '20:30', activity: 'ììœ  ë†€ì´ ì‹œê°„', description: 'ì•„ì´ê°€ ì›í•˜ëŠ” ë†€ì´ë¥¼ í•˜ë©° ë§ˆìŒê» ìƒìƒë ¥ì„ í¼ì³ìš”.', category: 'ë†€ì´', icon: 'ğŸ‰' }, { time: '21:00', activity: 'ì˜· ì •ë¦¬í•˜ê¸°', description: 'ë²—ì€ ì˜·ì„ ìŠ¤ìŠ¤ë¡œ ì •ë¦¬í•˜ëŠ” ì—°ìŠµì„ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ‘•' }, { time: '21:30', activity: 'ì·¨ì¹¨ ì¤€ë¹„', description: 'ë‚´ì¼ì„ ìœ„í•´ ì°¨ë¶„í•˜ê²Œ ì ìë¦¬ì— ë“¤ ì¤€ë¹„ë¥¼ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ì”»ê¸°' }, ],
                'ê¸ˆ': [{ time: '17:00', activity: 'ì‚¬íšŒì„± ìˆ˜ì—… (ì™¸ë¶€)', description: 'ì¹œêµ¬ë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ” ë°©ë²•ì„ ë°°ìš°ëŠ” ì‹œê°„ì´ì—ìš”.', category: 'ì¹˜ë£Œ', icon: 'ğŸ§‘â€ğŸ¤â€ğŸ§‘' }, { time: '18:00', activity: 'í‚¤ì¦ˆì¹´í˜ì—ì„œ ì‹ ë‚˜ê²Œ ë†€ê¸°', description: 'ì—ë„ˆì§€ë¥¼ ë°œì‚°í•˜ë©° ì¦ê±°ìš´ ì‹œê°„ì„ ë³´ë‚´ìš”.', category: 'ë†€ì´', icon: 'ğŸ¤¸' }, { time: '19:00', activity: 'ê°„ì‹ ë° ììœ ì‹œê°„', description: 'ì‹ ë‚˜ê²Œ ë†€ê³  ì™€ì„œ ê°„ë‹¨í•œ ê°„ì‹ì„ ë¨¹ì–´ìš”.', category: 'íœ´ì‹', icon: 'ğŸ' }, { time: '19:30', activity: 'ì§‘ ë„ì°© ë° ì €ë… ì‹ì‚¬', description: 'ì‹ ë‚˜ê²Œ ë†€ê³  ì™€ì„œ ë¨¹ëŠ” ì €ë…ì€ ê¿€ë§›ì´ì—ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '20:30', activity: 'í•¨ê»˜ ì±… ì½ê¸° ë˜ëŠ” ê°€ë²¼ìš´ í™œë™', description: 'í¥ë¶„ëœ ë§ˆìŒì„ ê°€ë¼ì•‰íˆê³  ì°¨ë¶„í•˜ê²Œ í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í•´ìš”.', category: 'ë…ì„œ', icon: 'ğŸ“–' }, { time: '21:00', activity: 'ì£¼ë§ ê³„íš ì´ì•¼ê¸°í•˜ê¸°', description: 'ì£¼ë§ì— ë¬´ì—‡ì„ í• ì§€ í•¨ê»˜ ì´ì•¼ê¸° ë‚˜ëˆ ìš”.', category: 'ë†€ì´', icon: 'ğŸ—“ï¸' }, { time: '21:30', activity: 'ì·¨ì¹¨ ì¤€ë¹„', description: 'ë‚´ì¼ì„ ìœ„í•´ ì°¨ë¶„í•˜ê²Œ ì ìë¦¬ì— ë“¤ ì¤€ë¹„ë¥¼ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ì”»ê¸°' }, ],
                'ì£¼ë§': [{ time: '09:00', activity: 'ê¸°ìƒ ë° ì•„ì¹¨ ì‹ì‚¬', description: 'ì£¼ë§ ì•„ì¹¨, ìƒì¾Œí•˜ê²Œ ì‹œì‘í•´ìš”!', category: 'ê¸°ë³¸ìƒí™œ', icon: 'â˜€ï¸' }, { time: '10:00', activity: 'ì§§ì€ 1:1 í•™ìŠµ (30-40ë¶„)', description: 'ì£¼ì¤‘ì— ë¶€ì¡±í–ˆë˜ ë¶€ë¶„ì„ ì¬ë¯¸ìˆëŠ” ë†€ì´ì²˜ëŸ¼ í•™ìŠµí•´ìš”.', category: 'í•™ìŠµ', icon: 'ğŸ“š' }, { time: '10:40', activity: 'í•¨ê»˜ ì±… ì½ê¸°', description: 'í¥ë¯¸ë¡œìš´ ì´ì•¼ê¸°ë¥¼ í•¨ê»˜ ì½ìœ¼ë©° ìƒìƒë ¥ì„ í‚¤ì›Œìš”.', category: 'ë…ì„œ', icon: 'ğŸ“–' }, { time: '11:30', activity: 'ììœ  ë†€ì´ ë˜ëŠ” ì•¼ì™¸ í™œë™', description: 'ì•„ì´ê°€ ì¢‹ì•„í•˜ëŠ” ë†€ì´ë¥¼ í•˜ê±°ë‚˜, ê°€ê¹Œìš´ ê³µì›ì—ì„œ ì‹ ì²´ í™œë™ì„ ì¦ê²¨ìš”.', category: 'ë†€ì´', icon: 'ğŸª' }, { time: '12:30', activity: 'ì ì‹¬ ì‹ì‚¬', description: 'ë§›ìˆëŠ” ì ì‹¬ì„ ë¨¹ê³  ì—ë„ˆì§€ë¥¼ ì¶©ì „í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ½ï¸' }, { time: '14:00', activity: 'ë¶€ëª¨ë‹˜ê³¼ íŠ¹ë³„ í™œë™/ì¹˜ë£Œ í›ˆë ¨', description: 'ì•„ì´ì—ê²Œ í•„ìš”í•œ ë§ì¶¤í˜• í›ˆë ¨(ì†Œê·¼ìœ¡, ì¸ì§€, ì–¸ì–´ ë“±)ì„ ë†€ì´ì²˜ëŸ¼ ì§„í–‰í•˜ê±°ë‚˜, í•¨ê»˜ íŠ¹ë³„í•œ í™œë™ì„ í•´ìš”.', category: 'ì¹˜ë£Œ', icon: 'ğŸ§©' }, { time: '15:00', activity: 'ììœ  ë†€ì´ ë° ê°„ì‹', description: 'í™œë™ í›„ ììœ ë¡­ê²Œ ë†€ë©° ê°„ì‹ì„ ë¨¹ì–´ìš”.', category: 'ë†€ì´', icon: 'ğŸ¦' }, { time: '16:00', activity: 'ì§‘ ì•ˆ ì •ë¦¬ ë•ê¸°', description: 'ì¥ë‚œê°ì´ë‚˜ ì±…ì„ ì •ë¦¬í•˜ë©° ì²­ê²° ìŠµê´€ì„ ê¸¸ëŸ¬ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸ§¹' }, { time: '17:00', activity: 'ê°€ì¡±ê³¼ í•¨ê»˜í•˜ëŠ” ì‹œê°„', description: 'ë³´ë“œê²Œì„, ì˜í™” ë³´ê¸°, ëŒ€í™” ë“± ê°€ì¡±ê³¼ ì¦ê±°ìš´ ì‹œê°„ì„ ë³´ë‚´ìš”.', category: 'ë†€ì´', icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' }, { time: '18:00', activity: 'í•˜ë£¨ ì¼ê³¼ ëŒì•„ë³´ê¸°', description: 'ì˜¤ëŠ˜ ë¬´ì—‡ì„ í–ˆëŠ”ì§€ ì´ì•¼ê¸° ë‚˜ëˆ„ë©° í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í•´ìš”.', category: 'ë…ì„œ', icon: 'ğŸ’¬' }, { time: '18:30', activity: 'ì €ë… ì‹ì‚¬', description: 'ì£¼ë§ ì €ë…ì€ íŠ¹ë³„í•œ ë©”ë‰´ë¡œ ì¦ê²ê²Œ!', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ğŸœ' }, { time: '19:30', activity: 'ë‹¤ìŒ ì£¼ê°„ ìŠ¤ì¼€ì¤„ ë¯¸ë¦¬ ë³´ê¸°', description: 'ë‹¤ìŒ ì£¼ ìŠ¤ì¼€ì¤„ì„ ë¯¸ë¦¬ ë³´ë©° ìƒˆë¡œìš´ í•œ ì£¼ë¥¼ ì¤€ë¹„í•´ìš”.', category: 'í•™ìŠµ', icon: 'ğŸ“…' }, { time: '20:00', activity: 'íœ´ì‹ ë° ì·¨ì¹¨ ì¤€ë¹„', description: 'í•˜ë£¨ë¥¼ ë§ˆë¬´ë¦¬í•˜ë©° í¸ì•ˆí•˜ê²Œ ì‰¬ê³  ì ìë¦¬ì— ë“¤ ì¤€ë¹„ë¥¼ í•´ìš”.', category: 'ê¸°ë³¸ìƒí™œ', icon: 'ì”»ê¸°' }]
            };
            const scheduleContent = document.getElementById('schedule-content');
            const dayTabsContainer = document.getElementById('day-tabs');
            const exploreDayTabsContainer = document.getElementById('explore-day-tabs');
            const exploreScheduleContent = document.getElementById('schedule-content-explore');
            const managementOverlay = document.getElementById('management-overlay');
            const managementContent = document.getElementById('management-content');
            const modal = document.getElementById('editModal');
            let currentActiveDay = 'ì›”';

            // --- ë°ì´í„° ê´€ë¦¬ í•¨ìˆ˜ ---
            function loadScheduleState() {
                const savedData = localStorage.getItem('childScheduleData_v2.1');
                if (savedData) { scheduleData = JSON.parse(savedData); } 
                else {
                    Object.keys(defaultSchedule).forEach(day => {
                        scheduleData[day] = defaultSchedule[day].map(activity => ({...activity, description: activity.description || '', completed: false, notified_5min: false, notified_start: false}));
                    });
                }
            }
            function saveScheduleState() { localStorage.setItem('childScheduleData_v2.1', JSON.stringify(scheduleData)); }
            function timeToMinutes(timeStr) { if (!timeStr || !timeStr.includes(':')) return 0; const [h, m] = timeStr.split(':').map(Number); return h * 60 + m; }
            function formatTimeForDisplay(timeStr) { if (!timeStr || !timeStr.includes(':')) return timeStr; let [h, m] = timeStr.split(':'); const ampm = h >= 12 ? 'ì˜¤í›„' : 'ì˜¤ì „'; h = h % 12 || 12; return `${ampm} ${h}:${m}`; }
            async function setupAudio() { /* ì´ì „ê³¼ ë™ì¼ */ }
            function playClapSound() { /* ì´ì „ê³¼ ë™ì¼ */ }

            // --- ì¼ì • í¸ì§‘/ê´€ë¦¬ í•¨ìˆ˜ ---
            function openModal(day, index = -1) {
                document.getElementById('modalDay').value = day;
                document.getElementById('modalIndex').value = index;
                document.getElementById('modalCategory').innerHTML = Object.keys(categoryColors).map(cat => `<option value="${cat}">${cat}</option>`).join('');
                if (index === -1) {
                    document.getElementById('modalTitle').textContent = `${day} ìƒˆ ì¼ì • ì¶”ê°€`;
                    document.getElementById('modalTime').value = '';
                    document.getElementById('modalActivity').value = '';
                    document.getElementById('modalDescription').value = '';
                    document.getElementById('modalCategory').value = 'ê¸°ë³¸ìƒí™œ';
                    document.getElementById('modalIcon').value = 'ğŸ“';
                } else {
                    document.getElementById('modalTitle').textContent = `${day} ì¼ì • ìˆ˜ì •`;
                    const activity = scheduleData[day][index];
                    document.getElementById('modalTime').value = activity.time;
                    document.getElementById('modalActivity').value = activity.activity;
                    document.getElementById('modalDescription').value = activity.description || '';
                    document.getElementById('modalCategory').value = activity.category;
                    document.getElementById('modalIcon').value = activity.icon;
                }
                modal.classList.remove('hidden');
            }
            function closeModal() { modal.classList.add('hidden'); }
            function saveActivity() {
                const day = document.getElementById('modalDay').value;
                const index = parseInt(document.getElementById('modalIndex').value, 10);
                const newActivity = {
                    time: document.getElementById('modalTime').value,
                    activity: document.getElementById('modalActivity').value.trim(),
                    description: document.getElementById('modalDescription').value.trim(),
                    category: document.getElementById('modalCategory').value,
                    icon: document.getElementById('modalIcon').value.trim() || 'ğŸ“',
                    completed: index === -1 ? false : scheduleData[day][index].completed,
                    notified_5min: false, notified_start: false
                };
                if (!newActivity.time || !newActivity.activity) { alert('ì‹œê°„ê³¼ í™œë™ ì´ë¦„ì€ í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.'); return; }
                if (index === -1) { scheduleData[day].push(newActivity); } 
                else { scheduleData[day][index] = newActivity; }
                scheduleData[day].sort((a, b) => timeToMinutes(a.time) - timeToMinutes(b.time));
                saveScheduleState();
                renderAll();
                closeModal();
            }
            function deleteActivity(day, index) {
                if (confirm(`'${scheduleData[day][index].activity}' ì¼ì •ì„ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    scheduleData[day].splice(index, 1);
                    saveScheduleState();
                    renderAll();
                }
            }

            // --- UI ë Œë”ë§ í•¨ìˆ˜ ---
            function createScheduleItemHtml(item) {
                const borderColor = categoryColors[item.category] || 'border-gray-200';
                const completedClass = item.completed ? 'completed-activity' : '';
                const checkboxHtml = `<input type="checkbox" data-action="check" class="activity-checkbox h-5 w-5 text-teal-600 rounded" ${item.completed ? 'checked' : ''}>`;
                return `<div class="relative flex items-start gap-4 timeline-item border-l-4 ${borderColor} pl-6 pr-4 py-3 rounded-lg ${completedClass}" data-activity-time="${item.time}"><div class="absolute -left-3.5 top-5 -translate-y-1/2 flex items-center justify-center w-8 h-8 rounded-full bg-white ring-4 ring-[#A4C3B2]"><span class="text-2xl">${item.icon}</span></div><div class="pt-1.5">${checkboxHtml}</div><div class="flex-1 activity-text"><p class="text-sm text-gray-500">${formatTimeForDisplay(item.time)}</p><h3 class="font-bold text-lg text-gray-800">${item.activity}</h3><p class="text-gray-600 text-sm">${item.description || ''}</p></div></div>`;
            }

            function renderSchedule(day) {
                scheduleContent.innerHTML = (scheduleData[day] || []).map(createScheduleItemHtml).join('');
            }
            
            function renderTabs() {
                const days = Object.keys(scheduleData);
                const todayIndex = new Date().getDay();
                let systemDay = { 0: 'ì£¼ë§', 1: 'ì›”', 2: 'í™”', 3: 'ìˆ˜', 4: 'ëª©', 5: 'ê¸ˆ', 6: 'ì£¼ë§' }[todayIndex];
                currentActiveDay = scheduleData[systemDay] ? systemDay : 'ì›”';
                
                const tabHtml = days.map(day => `<button data-day="${day}" class="px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ${day === currentActiveDay ? 'tab-active' : 'tab-inactive'}">${day}</button>`).join('');
                dayTabsContainer.innerHTML = tabHtml;
                exploreDayTabsContainer.innerHTML = tabHtml.replaceAll('tab-active', 'tab-inactive');
            }

            function renderManagementView() {
                managementContent.innerHTML = Object.keys(scheduleData).map(day => `
                    <div>
                        <h3 class="text-xl font-bold text-teal-700 bg-teal-50 p-3 rounded-t-lg">${day}</h3>
                        <div class="border rounded-b-lg">
                            ${scheduleData[day].map((item, index) => `
                                <div class="flex items-center justify-between p-3 border-b last:border-b-0">
                                    <div class="flex items-center gap-3"><span class="font-semibold text-gray-700 w-20">${formatTimeForDisplay(item.time)}</span><span>${item.activity}</span></div>
                                    <div class="flex gap-2"><button data-action="edit" data-day="${day}" data-index="${index}" class="text-sm bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-1 px-3 rounded">ìˆ˜ì •</button><button data-action="delete" data-day="${day}" data-index="${index}" class="text-sm bg-red-100 hover:bg-red-200 text-red-700 font-semibold py-1 px-3 rounded">ì‚­ì œ</button></div>
                                </div>
                            `).join('') || `<p class="p-3 text-gray-500">ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>`}
                        </div>
                        <div class="text-center mt-2"><button data-action="add" data-day="${day}" class="w-full bg-green-100 hover:bg-green-200 text-green-800 font-semibold py-2 px-4 rounded-lg transition-colors">+ ì´ ìš”ì¼ì— ì¼ì • ì¶”ê°€</button></div>
                    </div>
                `).join('');
            }

            function renderAll() {
                renderTabs();
                renderSchedule(currentActiveDay);
                // ì—¬ê¸°ì— ë‹¤ë¥¸ ë Œë”ë§ í•¨ìˆ˜ë“¤(ì°¨íŠ¸ ë“±)ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            }

            function updateCurrentActivityHighlight() {
                 document.querySelectorAll('#schedule-content .timeline-item').forEach(el => el.classList.remove('current-activity'));
                 const nowMinutes = new Date().getHours() * 60 + new Date().getMinutes();
                 const currentSchedule = scheduleData[currentActiveDay] || [];
                 let currentActivityTime = null;
                 for (let i = 0; i < currentSchedule.length; i++) {
                     if (currentSchedule[i].completed) continue;
                     if (timeToMinutes(currentSchedule[i].time) <= nowMinutes) {
                         currentActivityTime = currentSchedule[i].time;
                     } else { break; }
                 }
                 if (currentActivityTime) {
                     const el = document.querySelector(`#schedule-content .timeline-item[data-activity-time="${currentActivityTime}"]`);
                     if (el) {
                         el.classList.add('current-activity');
                         el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                     }
                 }
            }
            
            // --- ì•± ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
            function initializeApp() {
                loadScheduleState(); 
                setupAudio(); 
                renderAll();
                updateCurrentActivityHighlight();

                // ì´ë²¤íŠ¸ ìœ„ì„(Event Delegation)ìœ¼ë¡œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                scheduleContent.addEventListener('click', e => {
                    if (e.target.dataset.action === 'check') {
                        const time = e.target.closest('.timeline-item').dataset.activityTime;
                        const activity = scheduleData[currentActiveDay].find(item => item.time === time);
                        if(activity) {
                            activity.completed = e.target.checked;
                            saveScheduleState();
                            e.target.closest('.timeline-item').classList.toggle('completed-activity', activity.completed);
                            if (activity.completed) playClapSound();
                        }
                    }
                });
                dayTabsContainer.addEventListener('click', e => {
                    const day = e.target.dataset.day;
                    if (day) {
                        currentActiveDay = day;
                        renderAll();
                        updateCurrentActivityHighlight();
                    }
                });
                managementContent.addEventListener('click', e => {
                    const button = e.target.closest('button');
                    if (!button) return;
                    const { action, day, index } = button.dataset;
                    if (action === 'add') openModal(day);
                    if (action === 'edit') openModal(day, parseInt(index));
                    if (action === 'delete') deleteActivity(day, parseInt(index));
                });
                document.getElementById('manage-schedule-btn').addEventListener('click', () => { renderManagementView(); managementOverlay.classList.remove('hidden'); });
                document.getElementById('close-management-btn').addEventListener('click', () => { managementOverlay.classList.add('hidden'); });
                document.getElementById('saveButton').addEventListener('click', saveActivity);
                document.getElementById('cancelButton').addEventListener('click', closeModal);

                setInterval(() => { updateCurrentActivityHighlight(); }, 60000); 
            }

            initializeApp();
        });
    </script>
</body>
</html>